<!DOCTYPE html> <html lang=en  data-content_root="./"> <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=viewport  content="width=device-width, initial-scale=1" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="_static/stylesheets/application.css"/> <link rel=stylesheet  href="_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="_static/fonts/material-icons.css"/> <meta name=theme-color  content="#3f51b5"> <script src="_static/javascripts/modernizr.js"></script> <title>Developer Workflow &#8212; task-py</title> <link rel=stylesheet  type="text/css" href="_static/pygments.css?v=83e35b93" /> <link rel=stylesheet  type="text/css" href="_static/material.css?v=79c92029" /> <link rel=stylesheet  type="text/css" href="_static/copybutton.css?v=76b2166b" /> <script src="_static/documentation_options.js?v=4621528c"></script> <script src="_static/doctools.js?v=888ff710"></script> <script src="_static/sphinx_highlight.js?v=dc90522c"></script> <script src="_static/clipboard.min.js?v=a7894cd8"></script> <script src="_static/copybutton.js?v=38d0ae70"></script> <link rel=index  title=Index  href=genindex.html  /> <link rel=search  title=Search  href=search.html  /> <link rel=prev  title="lc_task.task module" href="api/lc_task.task.html" /> <body dir=ltr data-md-color-primary= data-md-color-accent=> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#DEVELOPMENT" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href=index.html  title=task-py  class="md-header-nav__button md-logo"> &nbsp; </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >task-py</span> <span class=md-header-nav__topic > Developer Workflow </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action=search.html  method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=""Search"" autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source > <a href="https://github.com/libcommon/task-py" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > task-py </div> </a> </div> </div> <script src="_static/javascripts/version_dropdown.js"></script> <script> var json_loc = "../versions.json", target_loc = "../", text = "Versions"; $( document ).ready( add_version_dropdown(json_loc, target_loc, text)); </script> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href=index.html  class=md-tabs__link >task-py</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href=index.html  title=task-py  class="md-nav__button md-logo"> <img src="_static/" alt=" logo" width=48  height=48 > </a> <a href=index.html  title=task-py >task-py</a> </label> <div class=md-nav__source > <a href="https://github.com/libcommon/task-py" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > task-py </div> </a> </div> <ul class=md-nav__list > <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >API Reference</span></span> <li class=md-nav__item > <a href="api/lc_task.html" class=md-nav__link >lc_task package</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Development</span></span> <li class=md-nav__item > <input class="md-toggle md-nav__toggle" data-md-toggle=toc  type=checkbox  id=__toc > <label class="md-nav__link md-nav__link--active" for=__toc > Developer Workflow </label> <a href="#" class="md-nav__link md-nav__link--active">Developer Workflow</a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >"Contents"</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#development--page-root" class=md-nav__link >Developer Workflow</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#overview" class=md-nav__link >Overview</a> <li class=md-nav__item ><a href="#requirements" class=md-nav__link >Requirements</a> <li class=md-nav__item ><a href="#build-container" class=md-nav__link >Build Container</a> <li class=md-nav__item ><a href="#build-cli" class=md-nav__link >Build CLI</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#initializing-the-repo" class=md-nav__link >Initializing the Repo</a> <li class=md-nav__item ><a href="#the-inner-loop" class=md-nav__link >The Inner Loop</a> <li class=md-nav__item ><a href="#build-cli-commands" class=md-nav__link >Build CLI Commands</a> <li class=md-nav__item ><a href="#adding-commands" class=md-nav__link >Adding Commands</a> </ul> </nav> <li class=md-nav__item ><a href="#writing-tests" class=md-nav__link >Writing Tests</a> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="_sources/DEVELOPMENT.md.txt">Show Source</a> </ul> </nav> <ul class=md-nav__list > <li class=md-nav__item > <a href="#overview" class=md-nav__link >Overview</a> <li class=md-nav__item > <a href="#requirements" class=md-nav__link >Requirements</a> <li class=md-nav__item > <a href="#build-container" class=md-nav__link >Build Container</a> <li class=md-nav__item > <a href="#build-cli" class=md-nav__link >Build CLI</a> <ul class=md-nav__list > <li class=md-nav__item > <a href="#initializing-the-repo" class=md-nav__link >Initializing the Repo</a> <li class=md-nav__item > <a href="#the-inner-loop" class=md-nav__link >The Inner Loop</a> <li class=md-nav__item > <a href="#build-cli-commands" class=md-nav__link >Build CLI Commands</a> <li class=md-nav__item > <a href="#adding-commands" class=md-nav__link >Adding Commands</a> </ul> <li class=md-nav__item > <a href="#writing-tests" class=md-nav__link >Writing Tests</a> </ul> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >"Contents"</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#development--page-root" class=md-nav__link >Developer Workflow</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#overview" class=md-nav__link >Overview</a> <li class=md-nav__item ><a href="#requirements" class=md-nav__link >Requirements</a> <li class=md-nav__item ><a href="#build-container" class=md-nav__link >Build Container</a> <li class=md-nav__item ><a href="#build-cli" class=md-nav__link >Build CLI</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#initializing-the-repo" class=md-nav__link >Initializing the Repo</a> <li class=md-nav__item ><a href="#the-inner-loop" class=md-nav__link >The Inner Loop</a> <li class=md-nav__item ><a href="#build-cli-commands" class=md-nav__link >Build CLI Commands</a> <li class=md-nav__item ><a href="#adding-commands" class=md-nav__link >Adding Commands</a> </ul> </nav> <li class=md-nav__item ><a href="#writing-tests" class=md-nav__link >Writing Tests</a> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="_sources/DEVELOPMENT.md.txt">Show Source</a> <li id=searchbox  class=md-nav__item > </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <section id=developer-workflow > <h1 id=development--page-root >Developer Workflow<a class=headerlink  href="#development--page-root" title="Link to this heading">¶</a></h1> <section id=overview > <h2 id=overview >Overview<a class=headerlink  href="#overview" title="Link to this heading">¶</a></h2> <p>This repository uses custom tooling based on shell (Bash) scripts and Docker to unify local and CI/CD workflows. The idea is that by running the developer workflow in a container, when those commands are run on CI/CD servers they will be executed in the exact same environment. While this does create an explicit dependency on a container runtime like Docker or Podman, it reduces the variance between local and remote environments and thus reduces the likelihood of “well, it works on my machine.” Unifying local and remote workflows is not a novel concept, but the build system in this repo is custom-built. This document describes in detail how to use and customize it. To skip the explanation and get started immediately, skip straight to <a class="reference internal" href="#initializing-the-repo">Initializing the Repo</a>.</p> </section> <section id=requirements > <h2 id=requirements >Requirements<a class=headerlink  href="#requirements" title="Link to this heading">¶</a></h2> <p>The build system currently only supports Linux (native or WSL) and macOS, and requires <a class="reference external" href="https://www.docker.com/">Docker</a> or another container runtime with a similar CLI. If you’re using an editor like Vim/Neovim and want to create a local virtual environment for code completion, you’ll also need a local Python installation. That’s it! All other development dependencies are installed in the build container.</p> </section> <section id=build-container > <h2 id=build-container >Build Container<a class=headerlink  href="#build-container" title="Link to this heading">¶</a></h2> <p>The build container, defined in <a class="reference download internal" download="" href="_downloads/f59b9065596dfc53f58d95dc0ae0be90/Dockerfile"><span class="xref download myst">build-support/docker/Dockerfile</span></a>, is based on <a class="reference external" href="https://hub.docker.com/_/alpine">Alpine Linux</a>. The repository files are mounted into the container before each command is run, so the container is not rebuilt after any source files are changed. To add tools or make other changes to the build container, edit the <code class="docutils literal notranslate"><span class=pre >build</span></code> or any preceding stage in the <a class="reference download internal" download="" href="_downloads/f59b9065596dfc53f58d95dc0ae0be90/Dockerfile"><span class="xref download myst">Dockerfile</span></a> and rebuild it (using the command <code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >build-base</span></code>, see below).</p> </section> <section id=build-cli > <h2 id=build-cli >Build CLI<a class=headerlink  href="#build-cli" title="Link to this heading">¶</a></h2> <p>All development commands are run via the <a class="reference download internal" download="" href="_downloads/ec22a0b8a666cc5753b90f573e49d3ce/run.sh"><span class="xref download myst">run.sh</span></a> script, which comes with many common commands built-in for Python development (detailed below). Certain build settings are configurable via <a class="reference download internal" download="" href="_downloads/39944d5d14db7ff5775a5228d2fbfcf5/config.sh"><span class="xref download myst">config.sh</span></a>, and each setting is documented in that file. If you are not using Docker, make sure to update the <code class="docutils literal notranslate"><span class=pre >CONTAINER_RUNTIME</span></code> setting in <code class="docutils literal notranslate"><span class=pre >config.sh</span></code> before continuing.</p> <section id=initializing-the-repo > <h3 id=initializing-the-repo >Initializing the Repo<a class=headerlink  href="#initializing-the-repo" title="Link to this heading">¶</a></h3> <p>Once you have installed a container runtime and it’s working properly, clear the workspace and build the build container:</p> <div class="highlight-bash notranslate"><div class=highlight ><pre><span></span>./run.sh<span class=w > </span>-l<span class=w > </span>clean<span class=w > </span><span class=o >&amp;&amp;</span><span class=w > </span>./run.sh<span class=w > </span>build-base
</pre></div> </div> <p>Initialize the project with a project name and description, module name, author, and source code license:</p> <div class="highlight-bash notranslate"><div class=highlight ><pre><span></span>./run.sh<span class=w > </span>init
</pre></div> </div> <p>If you are using an editor like Vim/Neovim and need a virtual environment for code completion, run the <code class="docutils literal notranslate"><span class=pre >editor-venv</span></code> command:</p> <div class="highlight-bash notranslate"><div class=highlight ><pre><span></span>./run.sh<span class=w > </span>editor-venv
</pre></div> </div> <p>This creates a virtual environment in <code class="docutils literal notranslate"><span class=pre >build-support/python/virtualenvs/editor-venv/</span></code>. See <a class="reference download internal" download="" href="_downloads/84faf3e208b22358d9226ffac1aa0f30/.ycm_extra_conf.py"><span class="xref download myst">.ycm_extra_conf.py</span></a> (for the YouCompleteMe plugin) for how to point a Vim/Neovim plugin to the virtual environment.</p> <p>Now you’re ready to start hacking!</p> </section> <section id=the-inner-loop > <h3 id=the-inner-loop >The Inner Loop<a class=headerlink  href="#the-inner-loop" title="Link to this heading">¶</a></h3> <p>The common set of steps you might want to perform while writing code are formatting, type checking, linting, testing, building, and publishing. The default command, <code class="docutils literal notranslate"><span class=pre >build</span></code>, checks the format and types, lints the code, runs unit tests, and builds a distribution package:</p> <div class="highlight-bash notranslate"><div class=highlight ><pre><span></span>./run.sh<span class=w > </span><span class=c1 ># equivalent to ./run.sh build</span>
</pre></div> </div> <p>This command should be run before comitting any code to the repo, and can be used in precommit hooks or CI/CD scripts. To format code before checking, run the <code class="docutils literal notranslate"><span class=pre >fmt</span></code> command before <code class="docutils literal notranslate"><span class=pre >build</span></code>:</p> <div class="highlight-bash notranslate"><div class=highlight ><pre><span></span>./run.sh<span class=w > </span>fmt<span class=w > </span><span class=se >\</span>
<span class=w >    </span><span class=o >&amp;&amp;</span><span class=w > </span>./run.sh<span class=w > </span>build
</pre></div> </div> <p>Once you’re ready to <em>publish</em> your code to <a class="reference external" href="https://pypi.org/">PyPI</a> or another registry, and compile the documentation, run:</p> <div class="highlight-bash notranslate"><div class=highlight ><pre><span></span>./run.sh<span class=w > </span>publish<span class=w > </span><span class=se >\</span>
<span class=w >    </span><span class=o >&amp;&amp;</span><span class=w > </span>./run.sh<span class=w > </span>make-docs
</pre></div> </div> </section> <section id=build-cli-commands > <h3 id=build-cli-commands >Build CLI Commands<a class=headerlink  href="#build-cli-commands" title="Link to this heading">¶</a></h3> <p>The table below contains all the built-in commands, their usage, and a brief description.</p> <table> <thead> <tr class=row-odd ><th class=head ><p>Command</p> <th class=head ><p>Usage</p> <th class=head ><p>Description</p> <tr class=row-even ><td><p>build</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >build</span></code></p> <td><p>Build distribution packages. Before building, this command will check the code format, run the type checker and linter, and run unit and integration tests. This is the default command.</p> <tr class=row-odd ><td><p>build-base</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >build-base</span></code></p> <td><p>Build the build container image.</p> <tr class=row-even ><td><p>check</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >check</span></code></p> <td><p>Type check code with <a class="reference external" href="https://mypy.readthedocs.io/en/stable/introduction.html">MyPy</a>.</p> <tr class=row-odd ><td><p>clean</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >clean</span></code></p> <td><p>Clean the workspace by removing the build virtual environment, compiled documentation and packages, and local caches.</p> <tr class=row-even ><td><p>editor-venv</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >editor-venv</span></code></p> <td><p>Create or update a local virtual environment for an editor (i.e., <a class="reference external" href="https://www.vim.org/">Vim</a>/<a class="reference external" href="https://neovim.io/">Neovim</a>).</p> <tr class=row-odd ><td><p>exec</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >exec</span> <span class=pre >COMMAND</span></code></p> <td><p>Execute arbitrary shell command (<code class="docutils literal notranslate"><span class=pre >COMMAND</span></code>) in virtual environment (using Poetry).</p> <tr class=row-even ><td><p>fmt</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >fmt</span></code></p> <td><p>Format code with <a class="reference external" href="https://black.readthedocs.io/en/stable/">Black</a>.</p> <tr class=row-odd ><td><p>init</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >init</span></code></p> <td><p>Initialize repository with project name and description, module name, author, and source code license (should only be run once - see <a class="reference internal" href="#initializing-the-repo">Initializing the Repo</a>).</p> <tr class=row-even ><td><p>lint</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >lint</span></code></p> <td><p>Lint code with <a class="reference external" href="https://pylint.pycqa.org/en/latest/intro.html">Pylint</a>.</p> <tr class=row-odd ><td><p>make-docs</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >make-docs</span></code></p> <td><p>Compile documentation with <a class="reference external" href="https://www.sphinx-doc.org/en/master/">Sphinx</a>.</p> <tr class=row-even ><td><p>publish</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >publish</span></code></p> <td><p>Publish distribution packages to PyPI (or another registry).</p> <tr class=row-odd ><td><p>push-base</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >push-base</span></code></p> <td><p>Push the build container image to the configured container registry (in <a class="reference download internal" download="" href="_downloads/39944d5d14db7ff5775a5228d2fbfcf5/config.sh"><span class="xref download myst">config.sh</span></a>).</p> <tr class=row-even ><td><p>shell</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >shell</span></code></p> <td><p>Sart a Python shell in the build virtual environment.</p> <tr class=row-odd ><td><p>test</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >test</span></code></p> <td><p>Run unit and documentation tests with <a class="reference external" href="https://docs.pytest.org/en/latest/">Pytest</a>.</p> <tr class=row-even ><td><p>update-deps</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >update-deps</span></code></p> <td><p>Update direct and dev dependencies in build virtual environment.</p> <tr class=row-odd ><td><p>version</p> <td><p><code class="docutils literal notranslate"><span class=pre >./run.sh</span> <span class=pre >version</span> <span class=pre >[VERSION]</span></code></p> <td><p>If a version (<code class="docutils literal notranslate"><span class=pre >VERSION</span></code>) is specified, updates the package version. Otherwise, shows the current package version.</p> </table> </section> <section id=adding-commands > <h3 id=adding-commands >Adding Commands<a class=headerlink  href="#adding-commands" title="Link to this heading">¶</a></h3> <p>Adding a command to the build CLI is designed to be simple, and only requires adding a function named <code class="docutils literal notranslate"><span class=pre >run-COMMAND</span></code> to <a class="reference download internal" download="" href="_downloads/ec22a0b8a666cc5753b90f573e49d3ce/run.sh"><span class="xref download myst">run.sh</span></a>. For example, the following snippet adds the command <code class="docutils literal notranslate"><span class=pre >bandit</span></code> to run the <a class="reference external" href="https://bandit.readthedocs.io/en/latest/">Bandit security tool</a> (after adding it as a dev dependency to <a class="reference download internal" download="" href="_downloads/b1a06b74a5029dcb8d0e6f89eae200a3/pyproject.toml"><span class="xref download myst">pyproject.toml</span></a>):</p> <div class="highlight-bash notranslate"><div class=highlight ><pre><span></span>run-bandit<span class=o >()</span><span class=w > </span><span class=o >{</span>
<span class=w >    </span>info<span class=w > </span><span class=s2 >"Running security scan with Bandit"</span>
<span class=w >    </span>poetry<span class=w > </span>run<span class=w > </span>bandit
<span class=o >}</span>
</pre></div> </div> <p>By default, commands will be run use the default Python version set in <code class="docutils literal notranslate"><span class=pre >config.sh</span></code>. To run a command in every support Python version, or locally-only, edit the <code class="docutils literal notranslate"><span class=pre >run-command</span></code> function in <code class="docutils literal notranslate"><span class=pre >run.sh</span></code>. After adding a command, make sure to update the usage in the <code class="docutils literal notranslate"><span class=pre >print-usage()</span></code> function and the <a class="reference internal" href="#build-cli-commands">commands table</a> above.</p> </section> </section> <section id=writing-tests > <h2 id=writing-tests >Writing Tests<a class=headerlink  href="#writing-tests" title="Link to this heading">¶</a></h2> <p>Tests are run by <a class="reference external" href="https://docs.pytest.org/en/latest/">Pytest</a>, and should be placed in the <code class="docutils literal notranslate"><span class=pre >tests/&lt;module_name&gt;</span></code> directory. All files named <code class="docutils literal notranslate"><span class=pre >test_*.py</span></code> in that directory that contain tests will be discovered by Pytest. See the <a class="reference external" href="https://docs.pytest.org/en/6.2.x/example/pythoncollection.html">Pytest discovery documentation</a> for more information. Examples in docstrings are also tested by <a class="reference external" href="https://docs.python.org/3/library/doctest.html">doctest</a> automatically, which keeps examples up-to-date and accurate.</p> <p><strong>NOTE:</strong> Support for <a class="reference external" href="https://peps.python.org/pep-0681">Dataclass Transforms</a> was not added until Python 3.11. Consequently, using the <code class="docutils literal notranslate"><span class=pre >@taskclass</span></code> decorator in this package will cause MyPy to wine about invalid task constructor arguments (<code class="docutils literal notranslate"><span class=pre >[call-arg]</span></code>). These errors can safely be ignored.</p> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> <a href="api/lc_task.task.html" title="lc_task.task module" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev > <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis > <span class=md-footer-nav__direction > "Previous" </span> lc_task.task module </span> </div> </a> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2023, Libcommon. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.2.6. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>